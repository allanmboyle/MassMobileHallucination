<style>
	.answer {
		font-size: 19pt;
	}
	.option {
		font-size: 19pt;
	}
	.hidden_answer {
		display: none;
	}
	.shown_answer {
		display: inline;
	}
	.answerrow {
		width: 100%;
	}
	.correct_answer {
		background-color: yellow;
	}
</style>
<div>
	<!-- TODO: convert this to a table -->
	<span>Question </span> <span id="q"></span><br/>
	<div class="answerrow">
		<span>A: </span> <span id="a1" class="option"></span> <span id="v1" class="answer hidden_answer"></span>
	</div>
	<div class="answerrow">
		<span>B: </span> <span id="a2" class="option"></span> <span id="v2" class="answer hidden_answer"></span><br/>
	</div>
	<div class="answerrow">
		<span>C: </span> <span id="a3" class="option"></span> <span id="v3" class="answer hidden_answer"></span><br/>
	</div>
	<div class="answerrow">
		<span>D: </span> <span id="a4" class="option"></span> <span id="v4" class="answer hidden_answer"></span><br/>
	</div>

	<input type=button value="Show Votes" onclick="showHideVotes()" />
	<input type=button value="Correct Answer?" onclick="showCorrectAnswer()" />
	<input type=button value="Next Question" onclick="nextQuestion()" />
</div>

<script src="/games/quiz/quiz_playfield.js"></script>

<script>
	var q = -1;
	
	var questions = [
		{q: "What film won the Oscar for best picture in 1984?", 
			c: 0, 
			a: ["One Flew Over the Cuckoo's Nest", "The Graduate", "Grease II", "Kramer vs. Kramer"]},
		{q: "Which country is home to the longest river in the world?", 
			c: 3,
			a: ["Egypt", "Luxemburg", "Monaco", "Siberia"]},
		{q: "Who won the 2008 AFL Grand Final?", 
			c: 2,
			a: ["The Hawks", "The Mighty Hawks", "Buddy Franklin", "Hawthorn Football Club"]},
		{q: "Who is the prime minster of Italy?", 
			c: 3,
			a: ["Roberto Benigni", "Silivio Belisconi", "Marco Montecelli", "Leonardo Da Vinci"]}
	];

	nextQuestion();

	function nextQuestion() {
		q++;
		if (q < questions.length) {
			hideVotes();
			$(".answerrow").removeClass("correct_answer");
			QuizPlayfield.clearVotes();

			$("#q").text((q+1) + ": " + questions[q].q);
			$("#a1").text(questions[q].a[0]);
			$("#a2").text(questions[q].a[1]);
			$("#a3").text(questions[q].a[2]);
			$("#a4").text(questions[q].a[3]);
		} else {
			q--; // go back to the last good question.
		}
	}

	var votesVisible = false;

	function showHideVotes() {
		(votesVisible)? hideVotes() : showVotes();
	}

	function hideVotes() {
		votesVisible = false;
		$(".answer").removeClass("shown_answer").addClass("hidden_answer");
	}

	function showVotes() {
		votesVisible = true;
		$(".answer").removeClass("hidden_answer").addClass("shown_answer");	
	}

	// TODO: make these perentages
	function updateVotes() {
		var answers = QuizPlayfield.calculateVotes();

		// add up totals to get the percentage
		var total = answers[0] + answers[1] + answers[2] + answers[3];

		$("#v1").text(percent(answers[0], total));
		$("#v2").text(percent(answers[1], total));
		$("#v3").text(percent(answers[2], total));
		$("#v4").text(percent(answers[3], total));
	}

	function percent(val, total) {
		if (total == 0) { return 0; }
		return Math.floor(val*100/total)
	}

	function showCorrectAnswer() {
		$($("div.answerrow")[questions[q].c]).addClass("correct_answer");
	}

	var voteTimer;
	function initPlayfield() {
		QuizPlayfield.init();

		// start a timer on the calculation of votes
		voteTimer = setInterval(updateVotes, 2000);

		return QuizPlayfield;
	}

	function shutdown() {
		clearInterval(voteTimer);
	}
</script>
