<style>
	.up_half { 
		height: 50%;
		width: 100%;
		overflow: hidden;
		margin: 0px;
		padding: 0px;
	}
	.down_half {
		height: 50%;
		width: 100%;
	}
	.left_side_up {
		background-color: FireBrick;
	}
	.left_side_down {
		background-color: IndianRed;
	}
	.right_side_up {
		background-color: ForestGreen;
	}
	.right_side_down {
		background-color: lightSeaGreen;
	}

	.big_word {
		color: midnightblue;
		position: relative;
		top: 10%;
		left: 10%;
		width: 80%;
		height: 80%;
		font-size: 30pt;
		opacity: 0.4;
		text-align: center;
		vertical-align: middle;
	}
 
	.pressed {
		border-style: inset;
		border-radius: 1px;
		border-color: black;
		opacity: 0.9;
	}
	.hidden { display: none;}
	.auditorium {
		position: absolute;
		top: 0; left: 0;
		width: 100%; height: 100%;
		background-color: midnightblue;
		font-size: 30pt;
		font-weight: 400;
		text-align: center;
		vertical-align: text-bottom;
	}
	.aud_left {
		width: 30%; height: 30%;
		float: left;
		border: 4px solid;
		margin-left: 10%;
		background-color: darkblue;
	}
	.aud_right {
		width: 30%; height: 30%;
		float: right;
		margin-right: 10%;
		border: 3px solid;
		background-color: darkblue;
	}
</style>

<div class="auditorium tron_white">
	<p>Where Are You Sitting?</p>
	<p class="aud_left" onclick="selectSide('left');">Left<br/>Side</p>
	<p class="aud_right" onclick="selectSide('right');">Right<br/>Side</p>
</div>

<div class="up_half hidden" onclick="clickedUp();"><div class="big_word">UP</div></div>
<div class="down_half hidden" onclick="clickedDown();"><div class="big_word">DOWN</div></div>

<script>
	var side;
	var lastTilt, nextTilt;

	function selectSide(side) {
		setSideColors(side);
	    MMH.listenForMovements(pongValuesProcessor, postProcessor);		
	    $(".auditorium").addClass("hidden");
	    $(".up_half").removeClass("hidden");
	    $(".down_half").removeClass("hidden");
	    // note: we don't get mmh to send for us, that we do in post()
	}

	// Note: these two methods added just for win phone 7.
	function clickedUp() 	{ MMH.storeOrientation(0,-1);}
	function clickedDown() 	{ MMH.storeOrientation(0,+1);}

	function initClient() {
	    MMH.init(socket);
	}

	function stopClient() {
		MMH.stopListeningForMovements();
	}

	// The mmh detectors convert all detected values to +90 to -90. We want
	// that from +1 to -1 for pong becuase its only an up for down.
	function pongValuesProcessor(accel) {
		accel.tiltFB = (accel.tiltFB >= 0)? 1 : -1;
		nextTilt = accel.tiltFB;
		return accel;
	}

	function postProcessor() {
		if (nextTilt != lastTilt) {
			// if there is a new value
			if (nextTilt > 0)  { 
				$(".up_half .big_word").removeClass("pressed")
				$(".down_half .big_word").addClass("pressed")
			} else {
				$(".down_half .big_word").removeClass("pressed")
				$(".up_half .big_word").addClass("pressed")
			}
			lastTilt = nextTilt;

			// send to the server only if change
			MMH.sendOrientationToServer();
		}
	}

	function setSideColors(side) {
		MMH.setPlayerLocation(side);

		if (side == "left") {
			$(".up_half").addClass("left_side_up");
			$(".down_half").addClass("left_side_down");
		} else {
			$(".up_half").addClass("right_side_up");
			$(".down_half").addClass("right_side_down");
		}
	}
</script>
